# äºˆç®—åŸºæº–ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçµ‚äº†æ¡ä»¶

## æ¦‚è¦
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çµ‚äº†åˆ¤æ–­ã‚’PMã®ä¸»è¦³ã§ã¯ãªãã€ã‚¹ãƒ‘ã‚³ãƒ³äºˆç®—ï¼ˆè¨ˆç®—ãƒã‚¤ãƒ³ãƒˆï¼‰ã®æ¶ˆè²»çŠ¶æ³ã«åŸºã¥ã„ã¦å®¢è¦³çš„ã«è¡Œã†ã€‚

## åŸºæœ¬åŽŸå‰‡
- **ä¸»è¦³çš„åˆ¤æ–­ã®æŽ’é™¤**: PMã®ã€Œãã‚ãã‚çµ‚ã‚ã‚Šã«ã—ã‚ˆã†ã€ã¨ã„ã†ä¸»è¦³çš„åˆ¤æ–­ã‚’å®Œå…¨ã«æŽ’é™¤
- **é€æ˜Žæ€§ã®ç¢ºä¿**: å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒçµ‚äº†æ¡ä»¶ã¨ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚ºã‚’æŠŠæ¡å¯èƒ½
- **æ®µéšŽçš„å¯¾å¿œ**: äºˆç®—æ¶ˆè²»çŽ‡ã«å¿œã˜ãŸæ®µéšŽçš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³

## äºˆç®—æ¶ˆè²»ã«ã‚ˆã‚‹æ®µéšŽçš„å¯¾å¿œ

### ðŸ”µ ãƒ•ã‚§ãƒ¼ã‚º0: æœªé”æˆæœŸï¼ˆ0-æœ€ä½Žæ¶ˆè²»é‡ï¼‰
- **çŠ¶æ…‹**: æœ€ä½Žæ¶ˆè²»é‡ã«æœªåˆ°é”
- **å•é¡Œ**: åŸºæœ¬å‹•ä½œç¢ºèªã™ã‚‰å®Œäº†ã—ã¦ã„ãªã„
- **å¯¾å¿œ**:
  - ãƒ­ã‚°ã‚¤ãƒ³ãƒŽãƒ¼ãƒ‰å®Ÿè¡Œã®ç–‘ã„ã‚’å³åº§ã«èª¿æŸ»
  - ã‚¸ãƒ§ãƒ–æŠ•å…¥æ–¹æ³•ã®ç¢ºèª
  - ç’°å¢ƒæ§‹ç¯‰ã®å•é¡Œã‚’å„ªå…ˆè§£æ±º
  - PMã®ã€Œãã‚ãã‚çµ‚ã‚ã‚Šã€åˆ¤æ–­ã‚’é˜²ããŸã‚ç©æ¥µçš„ã«å®Ÿè¡Œ

### ðŸŸ¢ ãƒ•ã‚§ãƒ¼ã‚º1: ç©æ¥µçš„æŽ¢ç´¢æœŸï¼ˆæœ€ä½Žæ¶ˆè²»é‡-æƒ³å®šæ¶ˆè²»é‡ã®50%ï¼‰
- **çŠ¶æ…‹**: åŸºæœ¬å‹•ä½œç¢ºèªå®Œäº†ã€äºˆç®—ã«ä½™è£•ã‚ã‚Š
- **æˆ¦ç•¥**: 
  - æ–°ã—ã„æœ€é©åŒ–æ‰‹æ³•ã‚’ç©æ¥µçš„ã«è©¦è¡Œ
  - è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åºƒç¯„å›²ã«æŽ¢ç´¢
  - ä¸¦åˆ—åº¦ã®é«˜ã„å®Ÿé¨“ã‚’æŽ¨å¥¨

### ðŸŸ¡ ãƒ•ã‚§ãƒ¼ã‚º2: åŠ¹çŽ‡é‡è¦–æœŸï¼ˆæƒ³å®šæ¶ˆè²»é‡ã®50%-80%ï¼‰
- **çŠ¶æ…‹**: é †èª¿ã«é€²è¡Œä¸­
- **æˆ¦ç•¥**:
  - æˆæžœã®å‡ºã¦ã„ã‚‹æ‰‹æ³•ã«é›†ä¸­
  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®åŽæŸã‚’æ„è­˜
  - ã‚³ã‚¹ãƒˆåŠ¹çŽ‡ã‚’é‡è¦–

### ðŸŸ  ãƒ•ã‚§ãƒ¼ã‚º3: åŽæŸæœŸï¼ˆæƒ³å®šæ¶ˆè²»é‡ã®80%-100%ï¼‰
- **çŠ¶æ…‹**: æƒ³å®šæ¶ˆè²»é‡ã«æŽ¥è¿‘
- **æˆ¦ç•¥**:
  - æœ€ã‚‚æœ‰æœ›ãªæœ€é©åŒ–ã®ã¿ç¶™ç¶š
  - æ–°è¦å®Ÿè£…ã‚’æ…Žé‡ã«åˆ¤æ–­
  - æˆæžœã®ã¾ã¨ã‚ã‚’é–‹å§‹

### ðŸ”´ ãƒ•ã‚§ãƒ¼ã‚º4: è­¦æˆ’æœŸï¼ˆæƒ³å®šæ¶ˆè²»é‡-ãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ã®90%ï¼‰
- **çŠ¶æ…‹**: ãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ã«æŽ¥è¿‘ä¸­
- **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:
  - æ–°è¦ã‚¸ãƒ§ãƒ–ã¯äº‹å‰æ‰¿èªåˆ¶
  - å®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ã®æ—©æœŸçµ‚äº†ã‚’æ¤œè¨Ž
  - æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆæº–å‚™

### â›” ãƒ•ã‚§ãƒ¼ã‚º5: å¼·åˆ¶çµ‚äº†ï¼ˆãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ã®90%-100%ï¼‰
- **çŠ¶æ…‹**: äºˆç®—ä¸Šé™é–“è¿‘
- **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:
  - æ–°è¦ã‚¸ãƒ§ãƒ–å®Œå…¨ç¦æ­¢
  - é‡è¦ã‚¸ãƒ§ãƒ–ã®ã¿å®Œäº†å¾…æ©Ÿ
  - 5åˆ†ä»¥å†…ã«å…¨ä½œæ¥­çµ‚äº†

## äºˆç®—è¿½è·¡æ–¹æ³•

### budget_history.mdã®è¨˜éŒ²å½¢å¼
```markdown
## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹å§‹æ™‚
- UTCæ™‚åˆ»: 2025-01-30T10:00:00Z
- é–‹å§‹æ™‚used: 12,345 ãƒã‚¤ãƒ³ãƒˆ
- æœ€ä½Žæ¶ˆè²»é‡: 100 ãƒã‚¤ãƒ³ãƒˆï¼ˆå¾“æ¥500â†’ç·©å’Œï¼‰
- æƒ³å®šæ¶ˆè²»é‡: 1,000 ãƒã‚¤ãƒ³ãƒˆ
- ãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³: 1,500 ãƒã‚¤ãƒ³ãƒˆ

## æœ€æ–°ç¢ºèªæ™‚
- UTCæ™‚åˆ»: 2025-01-30T12:00:00Z
- ç¾åœ¨ã®used: 12,845 ãƒã‚¤ãƒ³ãƒˆ
- **æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®ä½¿ç”¨é‡: 500 ãƒã‚¤ãƒ³ãƒˆ**
- æƒ³å®šæ¶ˆè²»é‡ã«å¯¾ã™ã‚‹é€²æ—: 50%
- ãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ã«å¯¾ã™ã‚‹æ¶ˆè²»çŽ‡: 25%
- **ç¾åœ¨ãƒ•ã‚§ãƒ¼ã‚º: ðŸŸ¡ ãƒ•ã‚§ãƒ¼ã‚º2: åŠ¹çŽ‡é‡è¦–æœŸ**
```

### ç›£è¦–ã‚³ãƒžãƒ³ãƒ‰ï¼ˆã‚¹ãƒ‘ã‚³ãƒ³ä¾å­˜ï¼‰
- ä¸è€: `charge`
- ãã®ä»–: `_remote_info/command.md`å‚ç…§
- **æ³¨æ„**: å„ã‚¹ãƒ‘ã‚³ãƒ³ã§äºˆç®—ç¢ºèªã‚³ãƒžãƒ³ãƒ‰ã¯ç•°ãªã‚‹ãŸã‚ã€å¿…ãšäº‹å‰ç¢ºèªã™ã‚‹ã“ã¨

### äºˆç®—åŠ¹çŽ‡ãƒ¡ãƒˆãƒªã‚¯ã‚¹
```
åŠ¹çŽ‡ã‚¹ã‚³ã‚¢ = (æ€§èƒ½å‘ä¸ŠçŽ‡) / (ãƒã‚¤ãƒ³ãƒˆæ¶ˆè²»)

åˆ¤å®šåŸºæº–:
- é«˜åŠ¹çŽ‡: ã‚¹ã‚³ã‚¢ > 0.1
- æ¨™æº–: 0.01 < ã‚¹ã‚³ã‚¢ < 0.1  
- ä½ŽåŠ¹çŽ‡: ã‚¹ã‚³ã‚¢ < 0.01
```

## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥ã®å¯¾å¿œ

### PMï¼ˆäºˆç®—ç®¡ç†ã®ä¸­å¿ƒï¼‰
- **5-10åˆ†ã”ã¨**ã«äºˆç®—çŠ¶æ³ã‚’ç¢ºèª
- ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œæ™‚ã«å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸å³åº§ã«é€šçŸ¥
- äºˆç®—æ¶ˆè²»çŽ‡ã¨åŠ¹çŽ‡ã‚¹ã‚³ã‚¢ã«åŸºã¥ããƒªã‚½ãƒ¼ã‚¹å†é…åˆ†
- äºˆç®—åŸºæº–ã«ã‚ˆã‚‹å®¢è¦³çš„ãªçµ‚äº†æ±ºå®šï¼ˆä¸»è¦³æŽ’é™¤ï¼‰

```bash
# äºˆç®—ç¢ºèªã¨é€šçŸ¥ã®è‡ªå‹•åŒ–ï¼ˆã‚³ãƒžãƒ³ãƒ‰ã¯ã‚¹ãƒ‘ã‚³ãƒ³ã«ã‚ˆã‚Šç•°ãªã‚‹ï¼‰
# ä¾‹: ä¸è€ã®å ´åˆ
current_usage=$(charge | grep "used" | awk '{print $2}')
consumption_rate=$((current_usage * 100 / budget_limit))

if [ $consumption_rate -ge 70 ] && [ $last_phase != "åŽæŸæœŸ" ]; then
    agent_send.sh ALL "[PM] äºˆç®—æ¶ˆè²»çŽ‡70%åˆ°é”ã€‚ãƒ•ã‚§ãƒ¼ã‚º3:åŽæŸæœŸã«ç§»è¡Œã€‚æ–°è¦å®Ÿè£…ã‚’åœæ­¢ã—ã¦ãã ã•ã„ã€‚"
fi
```

### SEï¼ˆäºˆç®—åŠ¹çŽ‡ã®åˆ†æžï¼‰
- äºˆç®—åŠ¹çŽ‡ï¼ˆãƒã‚¤ãƒ³ãƒˆ/æ€§èƒ½å‘ä¸Šï¼‰ã‚’å®šæœŸçš„ã«è¨ˆç®—
- éžåŠ¹çŽ‡ãªPGã®ç‰¹å®šã¨æ”¹å–„ææ¡ˆ
- äºˆç®—æ¶ˆè²»äºˆæ¸¬ã‚°ãƒ©ãƒ•ã®ç”Ÿæˆ
- ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œã®å¦¥å½“æ€§ã‚’æ¤œè¨¼

### PGï¼ˆäºˆç®—æ„è­˜ã—ãŸå®Ÿè£…ï¼‰
- **ã‚¸ãƒ§ãƒ–æŠ•å…¥å‰ã«å¿…ãšäºˆç®—ãƒ•ã‚§ãƒ¼ã‚ºã‚’ç¢ºèª**
- ãƒ•ã‚§ãƒ¼ã‚º3ä»¥é™ã¯æ–°è¦å®Ÿè£…ç¦æ­¢
- ãƒ•ã‚§ãƒ¼ã‚º4ã§ã¯æ—¢å­˜ã‚¸ãƒ§ãƒ–ã®çµæžœç¢ºèªã®ã¿
- é•·æ™‚é–“ã‚¸ãƒ§ãƒ–ã¯äº‹å‰ã«PMã¸ç›¸è«‡

```bash
# PGã®ã‚¸ãƒ§ãƒ–æŠ•å…¥å‰ãƒã‚§ãƒƒã‚¯
if [ $current_phase -ge 4 ]; then
    echo "[ERROR] ãƒ•ã‚§ãƒ¼ã‚º4ä»¥é™ã¯æ–°è¦ã‚¸ãƒ§ãƒ–æŠ•å…¥ç¦æ­¢"
    agent_send.sh PM "[PG] æ–°è¦ã‚¸ãƒ§ãƒ–æŠ•å…¥ã‚’è©¦ã¿ã¾ã—ãŸãŒã€ãƒ•ã‚§ãƒ¼ã‚º4ã®ãŸã‚ä¸­æ­¢ã—ã¾ã—ãŸ"
    exit 1
fi
```

### CDï¼ˆæˆæžœç‰©ä¿å…¨ï¼‰
- äºˆç®—çŠ¶æ³ã«é–¢ã‚ã‚‰ãšSOTAã‚³ãƒ¼ãƒ‰ã®å³åº§ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- ãƒ•ã‚§ãƒ¼ã‚º4åˆ°é”æ™‚ç‚¹ã§æœ€çµ‚GitHubåŒæœŸ

## äºˆç®—æž¯æ¸‡æ™‚ã®ç·Šæ€¥æ‰‹é †

1. **å³åº§ã«å®Ÿè¡Œ**
   - å…¨å®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ã®`scancel`/`qdel`
   - SSH/SFTPã‚»ãƒƒã‚·ãƒ§ãƒ³ã®çµ‚äº†
   - æœ€æ–°SOTAã‚³ãƒ¼ãƒ‰ã®GitHub push

2. **5åˆ†ä»¥å†…ã«å®Œäº†**
   - å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æœ€çµ‚ChangeLog.mdæ›´æ–°
   - final_report.mdã®ç”Ÿæˆ
   - æˆæžœç‰©ã®æ•´ç†

3. **ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—**
   - ã‚¹ãƒ‘ã‚³ãƒ³å´ã®å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ï¼ˆä»»æ„ï¼‰
   - ãƒ­ãƒ¼ã‚«ãƒ«ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤

## äºˆç®—é–¾å€¤ã¨æ¶ˆè²»çŽ‡ã®è¨ˆç®—

### 3æ®µéšŽã®äºˆç®—é–¾å€¤
PMãŒrequirement_definition.mdã§è¨­å®šã™ã‚‹3ã¤ã®é–¾å€¤ï¼š
1. **æœ€ä½Žæ¶ˆè²»é‡**: åŸºæœ¬å‹•ä½œç¢ºèªã«å¿…è¦ãªæœ€å°é™ã®ãƒã‚¤ãƒ³ãƒˆ
2. **æƒ³å®šæ¶ˆè²»é‡**: é€šå¸¸ã®æœ€é©åŒ–ä½œæ¥­ã§æœŸå¾…ã•ã‚Œã‚‹ãƒã‚¤ãƒ³ãƒˆ
3. **ãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çµ¶å¯¾ä¸Šé™

### æ¶ˆè²»çŽ‡ã®è¨ˆç®—æ–¹æ³•
```
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½¿ç”¨é‡ = ç¾åœ¨ã®usedå€¤ - é–‹å§‹æ™‚ã®usedå€¤
æ¶ˆè²»çŽ‡ = (æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½¿ç”¨é‡ / ãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³) Ã— 100
```

**é‡è¦**: 
- usedã¯**ãƒ¦ãƒ¼ã‚¶ã®å¹´é–“ç´¯ç©å€¤**ã§ã‚ã‚Šã€æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã ã‘ã®å€¤ã§ã¯ãªã„
- å¿…ãšé–‹å§‹æ™‚ã®usedå€¤ã¨ã®å·®åˆ†ã§è¨ˆç®—ã™ã‚‹ã“ã¨
- budget_history.mdã«å·®åˆ†ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã‚Œã‚’å‚ç…§

### ãƒ•ã‚§ãƒ¼ã‚ºåˆ¤å®šã®å®Ÿè£…è²¬ä»»
- **PMã®è²¬å‹™**: budget_history.mdã‚’5-10åˆ†ã”ã¨ã«æ›´æ–°ã—ã€æ¶ˆè²»çŽ‡ã‚’è¨ˆç®—
- **å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: budget_history.mdã‹ã‚‰ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚ºã‚’èª­ã¿å–ã‚‹
- ã‚¹ãƒ‘ã‚³ãƒ³å›ºæœ‰ã®äºˆç®—ç¢ºèªã‚³ãƒžãƒ³ãƒ‰ã¯`_remote_info/command.md`ã«è¨˜è¼‰

## é‡è¦ãªæ³¨æ„äº‹é …
- **ãƒ­ã‚°ã‚¤ãƒ³ãƒŽãƒ¼ãƒ‰å®Ÿè¡Œã¯åŽ³ç¦**: äºˆç®—æ¶ˆè²»ã—ãªã„ãŒè¦ç´„é•å
- **ãƒã‚¤ãƒ³ãƒˆæœªæ¶ˆè²»ã®è­¦å‘Š**: ã‚¸ãƒ§ãƒ–å®Ÿè¡Œå¾Œã‚‚æ¶ˆè²»ãŒãªã„å ´åˆã€å³åº§ã«è­¦å‘Š
- **äºˆç®—æƒ…å ±ã®æ‰±ã„**: å€‹äººæƒ…å ±ã®ãŸã‚ã€å…·ä½“çš„ãªæ®‹é¡ã¯è¨˜è¼‰ã—ãªã„ï¼ˆusedå€¤ã¨å·®åˆ†ã®ã¿ï¼‰
- **ä¸»è¦³çš„åˆ¤æ–­ã®å®Œå…¨æŽ’é™¤**: PMã®ã€Œãã‚ãã‚ã€ã¨ã„ã†åˆ¤æ–­ã¯ä¸€åˆ‡è¡Œã‚ãªã„